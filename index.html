<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>–ë–æ–º–∂-–ú–∞–≥–Ω–∞—Ç 8.0: Mining Edition</title>
    <style>
        :root { --bg: #0d1117; --panel: #161b22; --green: #238636; --red: #da3633; --blue: #1f6feb; --gold: #f0883e; --neon: #00ffc3; }
        body { margin:0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: #c9d1d9; text-align: center; }
        .panel { background: var(--panel); margin: 8px; padding: 12px; border-radius: 12px; border: 1px solid #30363d; }
        .stats-main { font-size: 1.3rem; color: var(--gold); font-weight: bold; margin-bottom: 10px; }
        .crypto-row { display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid #21262d; }
        button { padding: 8px 12px; border-radius: 6px; border: none; cursor: pointer; font-weight: bold; color: #fff; transition: 0.2s; }
        .btn-buy { background: var(--green); } .btn-sell { background: var(--red); } .btn-blue { background: var(--blue); }
        .tab-nav { display: flex; justify-content: center; gap: 5px; margin-bottom: 10px; }
        .tab-btn { background: #21262d; flex: 1; font-size: 0.8rem; }
        .active-tab { background: var(--blue); border-color: #58a6ff; }
        .mining-status { font-size: 0.8rem; color: var(--neon); margin: 5px 0; }
        .hidden { display: none; }
        #clickBtn { width: 95%; height: 60px; background: linear-gradient(45deg, #f0883e, #d35400); margin-bottom: 15px; border-radius: 15px; font-size: 1.2rem; }
    </style>
</head>
<body>

<div class="panel">
    <div class="stats-main">üí∞ <span id="money">0</span>$</div>
    <div style="font-size:0.8rem; color:#8b949e">‚ö° –ï–Ω–µ—Ä–≥—ñ—è: <span id="powerUse">0</span> –∫–í—Ç/–≥–æ–¥ (–í–∏—Ç—Ä–∞—Ç–∏: <span id="powerCost">0</span>$/—Å)</div>
    
    <div class="tab-nav">
        <button class="tab-btn active-tab" onclick="showTab('biz')">üè¢ –ë—ñ–∑–Ω–µ—Å</button>
        <button class="tab-btn" onclick="showTab('crypto')">üìâ –ë—ñ—Ä–∂–∞</button>
        <button class="tab-btn" onclick="showTab('mining')">‚õèÔ∏è –ú–∞–π–Ω—ñ–Ω–≥</button>
    </div>
</div>

<!-- –¢–ê–ë 1: –ë–Ü–ó–ù–ï–° -->
<div id="tab-biz" class="tab-content">
    <button id="clickBtn" onclick="doClick()">–ü–†–ê–¶–Æ–í–ê–¢–ò üí∏</button>
    <div id="bizList"></div>
</div>

<!-- –¢–ê–ë 2: –ö–†–ò–ü–¢–û–ë–Ü–†–ñ–ê -->
<div id="tab-crypto" class="tab-content hidden">
    <div class="panel">
        <h3>üìä –†–∏–Ω–æ–∫ –º–æ–Ω–µ—Ç</h3>
        <div id="cryptoList"></div>
    </div>
</div>

<!-- –¢–ê–ë 3: –ú–ê–ô–ù–Ü–ù–ì -->
<div id="tab-mining" class="tab-content hidden">
    <div class="panel">
        <h3 style="color:var(--neon)">üõ†Ô∏è –ö—Ä–∏–ø—Ç–æ-–§–µ—Ä–º–∞</h3>
        <p style="font-size:0.8rem">–ö—É–ø—É–π—Ç–µ –≤—ñ–¥–µ–æ–∫–∞—Ä—Ç–∏, —â–æ–± –¥–æ–±—É–≤–∞—Ç–∏ BTC –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ!</p>
        <div id="rigList"></div>
    </div>
</div>

<script>
// --- –ü–ê–†–ê–ú–ï–¢–†–ò –ì–†–ò ---
let g = JSON.parse(localStorage.getItem('homeless_v8')) || {
    money: 200,
    biz: [
        {name: "–ó–±—ñ—Ä –ø–ª—è—à–æ–∫", cost: 50, inc: 2, owned: 0},
        {name: "–ö—ñ–æ—Å–∫", cost: 500, inc: 15, owned: 0},
        {name: "–ú–∞–≥–∞–∑–∏–Ω", cost: 5000, inc: 180, owned: 0}
    ],
    crypto: [
        {id: 'btc', name: "Bitcoin", price: 45000, owned: 0, trend: 'up'},
        {id: 'eth', name: "Ethereum", price: 2800, owned: 0, trend: 'down'}
    ],
    mining: [
        {name: "GTX 1660", cost: 800, hashrate: 0.00001, power: 0.2, owned: 0},
        {name: "RTX 3080", cost: 3500, hashrate: 0.00008, power: 0.5, owned: 0},
        {name: "ASIC Miner", cost: 15000, hashrate: 0.0005, power: 2.0, owned: 0}
    ],
    powerPrice: 0.5 // –¶—ñ–Ω–∞ 1 –∫–í—Ç
};

function showTab(tabId) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
    document.getElementById('tab-' + tabId).classList.remove('hidden');
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active-tab'));
    event.currentTarget.classList.add('active-tab');
}

// --- –ö–†–ò–ü–¢–û –õ–û–ì–Ü–ö–ê ---
function updatePrices() {
    g.crypto.forEach(c => {
        let change = 1 + (Math.random() * 0.16 - 0.08); // +/- 8%
        c.price *= change;
        c.trend = change >= 1 ? 'up' : 'down';
    });
}

function buyCrypto(id) {
    let c = g.crypto.find(x => x.id === id);
    if(g.money >= c.price) { g.money -= c.price; c.owned++; updateUI(); }
}

function sellCrypto(id) {
    let c = g.crypto.find(x => x.id === id);
    if(c.owned > 0) { g.money += c.price; c.owned--; updateUI(); }
}

// --- –ú–ê–ô–ù–Ü–ù–ì –õ–û–ì–Ü–ö–ê ---
function buyRig(i) {
    if(g.money >= g.mining[i].cost) {
        g.money -= g.mining[i].cost;
        g.mining[i].owned++;
        g.mining[i].cost *= 1.3;
        updateUI();
    }
}

// --- –û–°–ù–û–í–ù–ï –û–ù–û–í–õ–ï–ù–ù–Ø ---
function updateUI() {
    document.getElementById('money').innerText = Math.floor(g.money);
    
    // –ë—ñ–∑–Ω–µ—Å
    let bHtml = '';
    g.biz.forEach((b, i) => {
        bHtml += `<div class="panel"><b>${b.name}</b> (x${b.owned})<br>
        <button class="btn-buy" onclick="buyBiz(${i})">–ö—É–ø–∏—Ç–∏ (${Math.floor(b.cost)}$)</button></div>`;
    });
    document.getElementById('bizList').innerHTML = bHtml;

    // –ö—Ä–∏–ø—Ç–∞
    let cHtml = '';
    g.crypto.forEach(c => {
        cHtml += `<div class="crypto-row">
            <div style="text-align:left"><b>${c.name}</b><br><span class="price-${c.trend}">${c.price.toFixed(2)}$</span></div>
            <div><button class="btn-buy" onclick="buyCrypto('${c.id}')">–í–∫–ª–∞–¥</button>
            <button class="btn-sell" onclick="sellCrypto('${c.id}')">–ü—Ä–æ–¥–∞—Ç–∏ (${c.owned.toFixed(4)})</button></div>
        </div>`;
    });
    document.getElementById('cryptoList').innerHTML = cHtml;

    // –ú–∞–π–Ω—ñ–Ω–≥
    let mHtml = '';
    let totalPower = 0;
    g.mining.forEach((m, i) => {
        totalPower += m.owned * m.power;
        mHtml += `<div class="panel">
            <b>${m.name}</b> (x${m.owned})<br>
            <small>–î–æ–±—É—Ç–æ–∫: ${m.hashrate} BTC/—Å | ‚ö° ${m.power} –∫–í—Ç</small><br>
            <button class="btn-blue" onclick="buyRig(${i})">–ö—É–ø–∏—Ç–∏ (${Math.floor(m.cost)}$)</button>
        </div>`;
    });
    document.getElementById('rigList').innerHTML = mHtml;
    document.getElementById('powerUse').innerText = totalPower.toFixed(1);
    document.getElementById('powerCost').innerText = (totalPower * g.powerPrice).toFixed(2);

    localStorage.setItem('homeless_v8', JSON.stringify(g));
}

function buyBiz(i) {
    if(g.money >= g.biz[i].cost) {
        g.money -= g.biz[i].cost;
        g.biz[i].owned++;
        g.biz[i].cost *= 1.4;
        updateUI();
    }
}

function doClick() { g.money += 1; updateUI(); }

// --- –Ü–ì–†–û–í–ò–ô –¶–ò–ö–õ ---
setInterval(() => {
    // 1. –î–æ—Ö—ñ–¥ –≤—ñ–¥ –±—ñ–∑–Ω–µ—Å—É
    g.biz.forEach(b => g.money += (b.owned * b.inc / 10));

    // 2. –ú–∞–π–Ω—ñ–Ω–≥ BTC
    let btc = g.crypto.find(c => c.id === 'btc');
    let totalPower = 0;
    g.mining.forEach(m => {
        btc.owned += (m.owned * m.hashrate / 10);
        totalPower += (m.owned * m.power);
    });

    // 3. –í–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ —Å–≤—ñ—Ç–ª–æ
    g.money -= (totalPower * g.powerPrice / 10);
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –±–∞–Ω–∫—Ä—É—Ç—Å—Ç–≤–æ –ø–æ —Å–≤—ñ—Ç–ª—É
    if(g.money < 0) g.money = 0; 

    updateUI();
}, 100);

setInterval(updatePrices, 4000); // –†–∏–Ω–æ–∫ —Ä—É—Ö–∞—î—Ç—å—Å—è –∫–æ–∂–Ω—ñ 4—Å

updateUI();
</script>
</body>
</html>

<div class="log" id="gameLog">–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –Ω–∞ –≤—É–ª–∏—Ü—ñ, –º–∞–π–±—É—Ç–Ω—ñ–π –º—ñ–ª—å—è—Ä–¥–µ—Ä!</div>

<button id="clickBtn" class="btn-click">–ü–†–ê–¶–Æ–í–ê–¢–ò üí∏</button>

<div class="panel">
    <h3>üìà –®–≤–∏–¥–∫—ñ –¥—ñ—ó</h3>
    <button class="blue" onclick="depositBank()">–í—Å–µ –≤ –ë–∞–Ω–∫ (+0.2%/—Å–µ–∫)</button>
    <button class="orange" onclick="depositSafe()">–í—Å–µ –≤ –°–µ–π—Ñ (–ó–∞—Ö–∏—Å—Ç)</button>
    <button class="blue" onclick="withdrawAll()">–ó–Ω—è—Ç–∏ –≤—Å–µ</button>
</div>

<div id="bizList"></div>

<script>
const baseGame = {
    money: 0, bank: 0, safe: 0, hunger: 100,
    level: 1, bonus: 1, economy: 1, houseIdx: 0,
    lastTime: Date.now(),
    houses: [
        {name: "–ö–æ—Ä–æ–±–∫–∞", cost: 0, mult: 1},
        {name: "–ü—ñ–¥–≤–∞–ª", cost: 500, mult: 1.5},
        {name: "–ö–≤–∞—Ä—Ç–∏—Ä–∞", cost: 5000, mult: 3},
        {name: "–í—ñ–ª–ª–∞", cost: 50000, mult: 10}
    ],
    biz: [
        {name: "–ó–±—ñ—Ä –ø–ª—è—à–æ–∫", cost: 50, inc: 1, owned: 0, mngr: false},
        {name: "–ö—ñ–æ—Å–∫", cost: 300, inc: 5, owned: 0, mngr: false},
        {name: "–ú–∏–π–∫–∞ –∞–≤—Ç–æ", cost: 1500, inc: 20, owned: 0, mngr: false},
        {name: "–ú–µ—Ä–µ–∂–∞ –∫–∞—Ñ–µ", cost: 10000, inc: 120, owned: 0, mngr: false},
        {name: "IT-–ö–æ—Ä–ø–æ—Ä–∞—Ü—ñ—è", cost: 100000, inc: 800, owned: 0, mngr: false}
    ]
};

let g = JSON.parse(localStorage.getItem('homeless_pro_6')) || JSON.parse(JSON.stringify(baseGame));

function log(msg, color="#fff") {
    const l = document.getElementById('gameLog');
    l.innerHTML = `<span style="color:${color}">${msg}</span><br>${l.innerHTML}`;
}

function buyFood() {
    if(g.money >= 10) { g.money -= 10; g.hunger = Math.min(100, g.hunger + 30); updateUI(); }
}

function depositBank() { g.bank += g.money; g.money = 0; log("–ì—Ä–æ—à—ñ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ –≤ –±–∞–Ω–∫ –ø—ñ–¥ –≤—ñ–¥—Å–æ—Ç–∫–∏"); updateUI(); }
function depositSafe() { g.safe += g.money; g.money = 0; log("–ì—Ä–æ—à—ñ –∑–∞—Ö–æ–≤–∞–Ω—ñ –≤ —Å–µ–π—Ñ", "#f1c40f"); updateUI(); }
function withdrawAll() { g.money += (g.bank + g.safe); g.bank = 0; g.safe = 0; updateUI(); }

function randomEvent() {
    let r = Math.random();
    if(r < 0.05) { // –ì—Ä–∞–±—ñ–∂
        let loss = Math.floor(g.money * 0.5);
        if(loss > 0) {
            g.money -= loss;
            log(`–ö–†–ò–ú–Ü–ù–ê–õ: –í–∞—Å –ø–æ–≥—Ä–∞–±—É–≤–∞–ª–∏! –í–∫—Ä–∞–¥–µ–Ω–æ ${loss}$`, "#e74c3c");
        }
    } else if (r < 0.1) { // –ó–Ω–∞—Ö—ñ–¥–∫–∞
        let win = g.level * 50;
        g.money += win;
        log(`–£–î–ê–ß–ê: –í–∏ –∑–Ω–∞–π—à–ª–∏ –≥–∞–º–∞–Ω–µ—Ü—å —ñ–∑ ${win}$!`, "#2ecc71");
    }
}

function updateUI() {
    document.getElementById('money').innerText = Math.floor(g.money);
    document.getElementById('level').innerText = g.level;
    document.getElementById('house').innerText = g.houses[g.houseIdx].name;
    document.getElementById('hungerBar').style.width = g.hunger + "%";
    document.getElementById('hungerBar').style.background = g.hunger < 30 ? "var(--red)" : "var(--green)";
    
    let html = '';
    g.biz.forEach((b, i) => {
        html += `<div class="panel">
            <b>${b.name}</b> (x${b.owned}) | +${Math.floor(b.inc * g.bonus * g.economy)}/—Å–µ–∫<br>
            <button class="green" onclick="buyBiz(${i})">–ö—É–ø–∏—Ç–∏ (${Math.floor(b.cost)}$)</button>
            <button class="blue" onclick="hireMngr(${i})" ${b.mngr?'disabled':''}>
                ${b.mngr ? '–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–∞—Ü—é—î' : '–ú–µ–Ω–µ–¥–∂–µ—Ä ('+(b.cost*5)+'$)'}
            </button>
        </div>`;
    });
    document.getElementById('bizList').innerHTML = html;
    
    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –Ω–æ–≤–µ –∂–∏—Ç–ª–æ
    let nextHouse = g.houses[g.houseIdx + 1];
    if(nextHouse && g.money >= nextHouse.cost) {
        if(confirm(`–ü–µ—Ä–µ—ó—Ö–∞—Ç–∏ –≤ ${nextHouse.name} –∑–∞ ${nextHouse.cost}$?`)) {
            g.money -= nextHouse.cost;
            g.houseIdx++;
            g.bonus = nextHouse.mult;
            log(`–ù–û–í–û–°–Ü–õ–õ–Ø: –í–∏ —Ç–µ–ø–µ—Ä –∂–∏–≤–µ—Ç–µ –≤: ${nextHouse.name}!`, "#3498db");
        }
    }
    localStorage.setItem('homeless_pro_6', JSON.stringify(g));
}

function buyBiz(i) {
    if(g.money >= g.biz[i].cost) {
        g.money -= g.biz[i].cost;
        g.biz[i].owned++;
        g.biz[i].cost *= 1.5;
        updateUI();
    }
}

function hireMngr(i) {
    let price = g.biz[i].cost * 5;
    if(g.money >= price) {
        g.money -= price;
        g.biz[i].mngr = true;
        updateUI();
    }
}

document.getElementById('clickBtn').onclick = () => {
    if(g.hunger <= 0) return log("–í–∏ –∑–∞–Ω–∞–¥—Ç–æ –≥–æ–ª–æ–¥–Ω—ñ, —â–æ–± –ø—Ä–∞—Ü—é–≤–∞—Ç–∏!", "#e74c3c");
    let gain = (1 + g.houseIdx) * g.bonus;
    g.money += gain;
    g.hunger -= 0.2;
    updateUI();
};

// –ì–æ–ª–æ–≤–Ω–∏–π —Ü–∏–∫–ª
setInterval(() => {
    // –î–æ—Ö—ñ–¥ –≤—ñ–¥ –±—ñ–∑–Ω–µ—Å—É
    g.biz.forEach(b => {
        if(b.mngr) g.money += (b.owned * b.inc * g.bonus * g.economy);
    });
    
    // –ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –≤—ñ–¥—Å–æ—Ç–∫–∏
    g.bank *= 1.002;
    
    // –ì–æ–ª–æ–¥
    g.hunger = Math.max(0, g.hunger - 0.5);
    
    // –ü–æ–¥—ñ—ó —Ç–∞ –ï–∫–æ–Ω–æ–º—ñ–∫–∞
    if(Math.random() < 0.1) randomEvent();
    
    updateUI();
}, 1000);

updateUI();
</script>
</body>
</html>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="bizContainer"></div>
</div>

<script>
// =================== GAME DATA ===================
const baseGame = {
money:0,
clickPower:1,
level:1,
bonus:1,
economy:1,
crisisTimer:0,
bankMoney:0,
safeMoney:0,
business:[
{name:"–ö–∏–æ—Å–∫",cost:100,income:2,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ú–∞–≥–∞–∑–∏–Ω",cost:500,income:6,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–∞—Ñ–µ",cost:2000,income:15,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ú–∏–Ω–∏-–∑–∞–≤–æ–¥",cost:5000,income:30,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ó–∞–≤–æ–¥",cost:8000,income:40,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–§–∞–±—Ä–∏–∫–∞",cost:15000,income:70,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",cost:40000,income:120,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ë–∞–Ω–∫",cost:100000,income:300,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"IT-–∫–æ–º–ø–∞–Ω–∏—è",cost:250000,income:500,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–¢–æ—Ä–≥–æ–≤–∞—è —Å–µ—Ç—å",cost:600000,income:1200,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ê–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è",cost:1500000,income:3000,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ñ–µ–ª–µ–∑–Ω–∞—è –¥–æ—Ä–æ–≥–∞",cost:3000000,income:6000,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–≠–Ω–µ—Ä–≥–æ–∫–æ–º–ø–∞–Ω–∏—è",cost:6000000,income:12000,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ñ–∏—Ä–º–∞",cost:12000000,income:25000,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–¢–µ—Ö–Ω–æ–≥–∏–≥–∞–Ω—Ç",cost:25000000,income:50000,owned:0,upgrade:0,manager:false,incomeAccum:0}
],
lastTime:Date.now()
};
let game;

// =================== LOAD / SAVE ===================
function save(){game.lastTime=Date.now(); localStorage.setItem("beggarV53",JSON.stringify(game));}
function load(){
let s=localStorage.getItem("beggarV53");
game=s?Object.assign(structuredClone(baseGame),JSON.parse(s)):structuredClone(baseGame);
let offlineSec=Math.floor((Date.now()-game.lastTime)/1000);
offlineSec=Math.min(offlineSec,28800);
if(offlineSec>0){
game.business.forEach(b=>b.incomeAccum += offlineSec*b.owned*b.income*(b.upgrade+1));
alert("‚è≥ –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥ –Ω–∞–∫–æ–ø–ª–µ–Ω!");
}
}

// =================== LEVEL ===================
function updateLevel(){
let lvl=Math.floor(Math.log10(game.money+1))+1;
if(lvl>game.level){game.level=lvl; game.bonus=1+(game.level-1)*0.1;}
}

// =================== ECONOMY ===================
function economyTick(){
game.crisisTimer++;
if(game.crisisTimer>20){
game.crisisTimer=0;
let r=Math.random();
if(r<0.25){game.economy=0.5; setEconomyText("üí• –ö–†–ò–ó–ò–°"); game.business.forEach(b=>b.incomeAccum*=0.8);}
else if(r<0.5){game.economy=0.8; setEconomyText("üìâ –°–ø–∞–¥");}
else if(r<0.75){game.economy=1.2; setEconomyText("üìà –†–æ—Å—Ç");}
else{game.economy=1.5; setEconomyText("üöÄ –ë—É–º");}
}}
function setEconomyText(text){document.getElementById("economy").innerText=text;}

// =================== BUSINESS LOGIC ===================
function buyBiz(i){let b=game.business[i]; if(game.money<b.cost) return; game.money-=b.cost; b.owned++; b.cost=Math.floor(b.cost*1.5); updateUI();}
function upgradeBiz(i){let b=game.business[i]; let price=b.cost*2; if(game.money<price) return; game.money-=price; b.upgrade++; updateUI();}
function collectBiz(i){let b=game.business[i]; game.money += Math.floor(b.incomeAccum*game.bonus*game.economy); b.incomeAccum=0; updateUI();}
function hireManager(i){let b=game.business[i]; let price=b.cost*5; if(game.money<price||b.manager) return; game.money-=price; b.manager=true; updateUI();}
function managerTick(){game.business.forEach(b=>{
    // –ï–∂–µ—Å–µ–∫—É–Ω–¥–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞
    let incomeThisTick = b.owned * b.income * (b.upgrade+1);
    if(b.manager){
        game.money += incomeThisTick * game.bonus * game.economy;
    } else {
        b.incomeAccum += incomeThisTick;
    }
});}

// =================== BANK / SAFE ===================
function depositBank(){if(game.money<=0) return; game.bankMoney+=game.money; game.money=0; updateUI();}
function withdrawBank(){if(game.bankMoney<=0) return; game.money+=game.bankMoney; game.bankMoney=0; updateUI();}
function depositSafe(){if(game.money<=0) return; game.safeMoney+=game.money; game.money=0; updateUI();}
function withdrawSafe(){if(game.safeMoney<=0) return; game.money+=game.safeMoney; game.safeMoney=0; updateUI();}

// =================== UI ===================
function drawBiz(){
const container=document.getElementById("bizContainer");
container.innerHTML="";
game.business.forEach((b,i)=>{
let panel=document.createElement("div"); panel.className="panel";
panel.innerHTML=`
<b>${b.name}</b><br>
–¶–µ–Ω–∞: ${b.cost}$<br>
–î–æ—Ö–æ–¥/—Å–µ–∫: ${b.income*(b.upgrade+1)}<br>
–í–ª–∞–¥–µ–Ω–∏–µ: x${b.owned}<br>
–ù–∞–∫–æ–ø–ª–µ–Ω–æ: ${Math.floor(b.incomeAccum)}$<br>
`;
let buyBtn=document.createElement("button"); buyBtn.className="green"; buyBtn.innerText="–ö—É–ø–∏—Ç—å"; buyBtn.onclick=()=>buyBiz(i);
let upgradeBtn=document.createElement("button"); upgradeBtn.className="blue"; upgradeBtn.innerText=`–ê–ø–≥—Ä–µ–π–¥ (${b.cost*2}$)`; upgradeBtn.onclick=()=>upgradeBiz(i);
let collectBtn=document.createElement("button"); collectBtn.className="green"; collectBtn.innerText="–°–æ–±—Ä–∞—Ç—å"; collectBtn.onclick=()=>collectBiz(i);
let managerBtn=document.createElement("button"); managerBtn.className="blue"; managerBtn.innerText=b.manager?"‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä":"–ù–∞–Ω—è—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞"; managerBtn.onclick=()=>hireManager(i);
panel.appendChild(document.createElement("br"));
panel.appendChild(buyBtn); panel.appendChild(upgradeBtn); panel.appendChild(document.createElement("br"));
panel.appendChild(collectBtn); panel.appendChild(managerBtn);
container.appendChild(panel);
});
}

function updateUI(){
document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=game.bonus.toFixed(1);
document.getElementById("bankMoney").innerText=Math.floor(game.bankMoney);
document.getElementById("safeMoney").innerText=Math.floor(game.safeMoney);
drawBiz();
save();
}

// =================== CLICK ===================
document.getElementById("clickBtn").addEventListener("click", ()=>{
game.money += game.clickPower*game.bonus;
updateLevel();
updateUI();
});

// =================== GAME LOOP ===================
setInterval(()=>{
managerTick();
economyTick();
game.money += game.bankMoney*0.001; // –±–∞–Ω–∫ –¥–∞—ë—Ç –ø—Ä–æ—Ü–µ–Ω—Ç—ã
updateLevel();
updateUI();
},1000);

// =================== START ===================
load();
setEconomyText("–°—Ç–∞–±–∏–ª—å–Ω–æ");
updateUI();
</script>
</body>
</html>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="bizContainer"></div>
</div>

<script>
// =================== GAME DATA ===================
const baseGame = {
money:0,
clickPower:1,
level:1,
bonus:1,
economy:1,
crisisTimer:0,
bankMoney:0,
safeMoney:0,
business:[
{name:"–ö–∏–æ—Å–∫",cost:100,income:2,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ú–∞–≥–∞–∑–∏–Ω",cost:500,income:6,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–∞—Ñ–µ",cost:2000,income:15,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ú–∏–Ω–∏-–∑–∞–≤–æ–¥",cost:5000,income:30,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ó–∞–≤–æ–¥",cost:8000,income:40,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–§–∞–±—Ä–∏–∫–∞",cost:15000,income:70,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",cost:40000,income:120,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ë–∞–Ω–∫",cost:100000,income:300,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"IT-–∫–æ–º–ø–∞–Ω–∏—è",cost:250000,income:500,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–¢–æ—Ä–≥–æ–≤–∞—è —Å–µ—Ç—å",cost:600000,income:1200,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ê–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏—è",cost:1500000,income:3000,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ñ–µ–ª–µ–∑–Ω–∞—è –¥–æ—Ä–æ–≥–∞",cost:3000000,income:6000,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–≠–Ω–µ—Ä–≥–æ–∫–æ–º–ø–∞–Ω–∏—è",cost:6000000,income:12000,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ñ–∏—Ä–º–∞",cost:12000000,income:25000,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–¢–µ—Ö–Ω–æ–≥–∏–≥–∞–Ω—Ç",cost:25000000,income:50000,owned:0,upgrade:0,manager:false,incomeAccum:0}
],
lastTime:Date.now()
};
let game;

// =================== LOAD / SAVE ===================
function save(){game.lastTime=Date.now(); localStorage.setItem("beggarV52",JSON.stringify(game));}
function load(){
let s=localStorage.getItem("beggarV52");
game=s?Object.assign(structuredClone(baseGame),JSON.parse(s)):structuredClone(baseGame);
let offlineSec=Math.floor((Date.now()-game.lastTime)/1000);
offlineSec=Math.min(offlineSec,28800);
if(offlineSec>0){
game.business.forEach(b=>b.incomeAccum += offlineSec*b.owned*b.income);
alert("‚è≥ –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥ –Ω–∞–∫–æ–ø–ª–µ–Ω!");
}
}

// =================== LEVEL ===================
function updateLevel(){
let lvl=Math.floor(Math.log10(game.money+1))+1;
if(lvl>game.level){game.level=lvl; game.bonus=1+(game.level-1)*0.1;}
}

// =================== ECONOMY ===================
function economyTick(){
game.crisisTimer++;
if(game.crisisTimer>20){
game.crisisTimer=0;
let r=Math.random();
if(r<0.25){game.economy=0.5; setEconomyText("üí• –ö–†–ò–ó–ò–°"); game.business.forEach(b=>b.incomeAccum*=0.8);}
else if(r<0.5){game.economy=0.8; setEconomyText("üìâ –°–ø–∞–¥");}
else if(r<0.75){game.economy=1.2; setEconomyText("üìà –†–æ—Å—Ç");}
else{game.economy=1.5; setEconomyText("üöÄ –ë—É–º");}
}}
function setEconomyText(text){document.getElementById("economy").innerText=text;}

// =================== BUSINESS LOGIC ===================
function buyBiz(i){let b=game.business[i]; if(game.money<b.cost) return; game.money-=b.cost; b.owned++; b.cost=Math.floor(b.cost*1.5); updateUI();}
function upgradeBiz(i){let b=game.business[i]; let price=b.cost*2; if(game.money<price) return; game.money-=price; b.upgrade++; updateUI();}
function collectBiz(i){let b=game.business[i]; game.money += Math.floor(b.incomeAccum*game.bonus*game.economy); b.incomeAccum=0; updateUI();}
function hireManager(i){let b=game.business[i]; let price=b.cost*5; if(game.money<price||b.manager) return; game.money-=price; b.manager=true; updateUI();}
function managerTick(){game.business.forEach(b=>{if(b.manager) b.incomeAccum += b.owned*b.income;});}

// =================== BANK / SAFE ===================
function depositBank(){if(game.money<=0) return; game.bankMoney+=game.money; game.money=0; updateUI();}
function withdrawBank(){if(game.bankMoney<=0) return; game.money+=game.bankMoney; game.bankMoney=0; updateUI();}
function depositSafe(){if(game.money<=0) return; game.safeMoney+=game.money; game.money=0; updateUI();}
function withdrawSafe(){if(game.safeMoney<=0) return; game.money+=game.safeMoney; game.safeMoney=0; updateUI();}

// =================== UI ===================
function drawBiz(){
const container=document.getElementById("bizContainer");
container.innerHTML="";
game.business.forEach((b,i)=>{
let panel=document.createElement("div"); panel.className="panel";
panel.innerHTML=`
<b>${b.name}</b><br>
–¶–µ–Ω–∞: ${b.cost}$<br>
–î–æ—Ö–æ–¥/—Å–µ–∫: ${b.income*(b.upgrade+1)}<br>
–í–ª–∞–¥–µ–Ω–∏–µ: x${b.owned}<br>
–ù–∞–∫–æ–ø–ª–µ–Ω–æ: ${Math.floor(b.incomeAccum)}$<br>
`;
let buyBtn=document.createElement("button"); buyBtn.className="green"; buyBtn.innerText="–ö—É–ø–∏—Ç—å"; buyBtn.onclick=()=>buyBiz(i);
let upgradeBtn=document.createElement("button"); upgradeBtn.className="blue"; upgradeBtn.innerText=`–ê–ø–≥—Ä–µ–π–¥ (${b.cost*2}$)`; upgradeBtn.onclick=()=>upgradeBiz(i);
let collectBtn=document.createElement("button"); collectBtn.className="green"; collectBtn.innerText="–°–æ–±—Ä–∞—Ç—å"; collectBtn.onclick=()=>collectBiz(i);
let managerBtn=document.createElement("button"); managerBtn.className="blue"; managerBtn.innerText=b.manager?"‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä":"–ù–∞–Ω—è—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞"; managerBtn.onclick=()=>hireManager(i);
panel.appendChild(document.createElement("br"));
panel.appendChild(buyBtn); panel.appendChild(upgradeBtn); panel.appendChild(document.createElement("br"));
panel.appendChild(collectBtn); panel.appendChild(managerBtn);
container.appendChild(panel);
});
}

function updateUI(){
document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=game.bonus.toFixed(1);
document.getElementById("bankMoney").innerText=Math.floor(game.bankMoney);
document.getElementById("safeMoney").innerText=Math.floor(game.safeMoney);
drawBiz();
save();
}

// =================== CLICK ===================
document.getElementById("clickBtn").addEventListener("click", ()=>{
game.money += game.clickPower*game.bonus;
updateLevel();
updateUI();
});

// =================== GAME LOOP ===================
setInterval(()=>{
managerTick();
economyTick();
game.money += game.bankMoney*0.001; // –±–∞–Ω–∫ –¥–∞—ë—Ç –ø—Ä–æ—Ü–µ–Ω—Ç—ã
updateLevel();
updateUI();
},1000);

// =================== START ===================
load();
setEconomyText("–°—Ç–∞–±–∏–ª—å–Ω–æ");
updateUI();
</script>
</body>
</html>
.blue{background:#3498db}
.orange{background:#e67e22}
.red{background:#e74c3c}

.bar{
height:10px;
background:#333;
border-radius:6px;
overflow:hidden;
margin:4px 0;
}

.fill{
height:100%;
background:#2ecc71;
}
</style>
</head>
<body>

<h2>üî• –ö–ª–∏–∫–µ—Ä –ë–æ–º–∂–∞ PRO 4.5 EVOLUTION CLEAN</h2>

<div class="panel">
üí∞ –ù–∞–ª–∏—á–Ω—ã–µ: <span id="money"></span><br>
üí∞ –°–µ–π—Ñ: <span id="safe"></span><br>
üè¶ –ë–∞–Ω–∫: <span id="bank"></span><br>
‚≠ê –£—Ä–æ–≤–µ–Ω—å: <span id="level"></span><br>
‚ö° –ë–æ–Ω—É—Å: x<span id="bonus"></span><br>
üñ±Ô∏è –°–∏–ª–∞ –∫–ª–∏–∫–∞: x<span id="clickPower"></span><br>
üåç –≠–∫–æ–Ω–æ–º–∏–∫–∞: <span id="eco"></span>
</div>

<button class="green" id="clickBtn">–ö–ª–∏–∫</button>
<button onclick="moveSafe()">–í —Å–µ–π—Ñ</button>
<button onclick="moveBank()">–í –±–∞–Ω–∫</button>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="biz"></div>
</div>

<script>

// ‚úÖ –ê–ù–¢–ò-–ó–£–ú
document.addEventListener('touchstart', e => { if(e.touches.length>1) e.preventDefault(); }, {passive:false});
let lastTouchEnd=0;
document.addEventListener('touchend', e => { 
let now=Date.now(); 
if(now-lastTouchEnd<=300) e.preventDefault(); 
lastTouchEnd=now; 
}, false);

//////////////// –ò–ì–†–ê //////////////////

const baseGame={
money:0,
safe:0,
bank:0,
level:1,
bonus:1,
clickPower:1,
eco:1,
ecoTimer:0,
business:[]
};

// 20 –±–∏–∑–Ω–µ—Å–æ–≤
const names=[
"–ö–∏–æ—Å–∫","–ú–∞–≥–∞–∑–∏–Ω","–ö–∞—Ñ–µ","–ó–∞–≤–æ–¥","–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",
"–¢–¶","IT —Ñ–∏—Ä–º–∞","–ù–µ—Ñ—Ç–µ–≤—ã—à–∫–∞","–ê—ç—Ä–æ–ø–æ—Ä—Ç","–ö–∞–∑–∏–Ω–æ",
"–ë–∞–Ω–∫","–ó–∞–≤–æ–¥ –¥—Ä–æ–Ω–æ–≤","–ö—Ä–∏–ø—Ç–æ—Ñ–µ—Ä–º–∞","–ö–æ—Å–º–æ–¥—Ä–æ–º","–•–æ–ª–¥–∏–Ω–≥",
"–†–æ–±–æ—Ç–æ—Ç–µ–∫–∞","–ú–µ–≥–∞–º–æ–ª–ª","–§–∞–±—Ä–∏–∫–∞ —Ä–æ–±–æ—Ç–æ–≤","–°—É–ø–µ—Ä–∫–æ–º–ø–ª–µ–∫—Å","–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ö–æ–ª–¥–∏–Ω–≥"
];

names.forEach((n,i)=>{
baseGame.business.push({
name:n,
cost:100*Math.pow(3,i),
income:2*Math.pow(2,i),
owned:0,
upgrade:0,
storageLevel:0,
stored:0,
overflowTimer:0,
manager:false
});
});

let game=JSON.parse(localStorage.getItem("beggar45clean"))||structuredClone(baseGame);

//////////////// SAVE //////////////////

function save(){localStorage.setItem("beggar45clean",JSON.stringify(game));}

//////////////// –ö–õ–ò–ö //////////////////

const clickBtn=document.getElementById("clickBtn");
clickBtn.addEventListener('click',()=>{
let gain=game.clickPower*game.bonus*game.eco;
game.money+=gain;
clickBtn.style.transform="scale(1.2)";
setTimeout(()=>{clickBtn.style.transform="scale(1)";},80);
updateLevel();
update();
});

//////////////// SAFE / BANK //////////////////

function moveSafe(){game.safe+=game.money; game.money=0;}
function moveBank(){game.bank+=game.money; game.money=0;}

//////////////// LEVEL //////////////////

function updateLevel(){
let total=game.money+game.safe+game.bank;
let lvl=Math.floor(Math.log10(total+1))+1;
if(lvl>game.level){game.level=lvl; game.bonus=1+(game.level-1)*0.1;}
}

//////////////// ECONOMY //////////////////

function ecoTick(){
game.ecoTimer++;
if(game.ecoTimer>20){
game.ecoTimer=0;
let r=Math.random();
if(r<0.25){game.eco=0.6; setEco("üí• –ö—Ä–∏–∑–∏—Å")}
else if(r<0.5){game.eco=0.8; setEco("üìâ –°–ø–∞–¥")}
else if(r<0.75){game.eco=1.2; setEco("üìà –†–æ—Å—Ç")}
else{game.eco=1.5; setEco("üöÄ –ë—É–º")}
}
}
function setEco(t){document.getElementById("eco").innerText=t;}

//////////////// BUSINESS //////////////////

function buy(i){let b=game.business[i]; if(game.money<b.cost) return; game.money-=b.cost; b.owned++; b.cost=Math.floor(b.cost*1.4);}
function collect(i){let b=game.business[i]; game.money+=b.stored; b.stored=0; b.overflowTimer=0;}
function hire(i){let b=game.business[i]; let price=500*(i+1); if(game.money<price||b.manager) return; game.money-=price; b.manager=true;}
function upIncome(i){let b=game.business[i]; let price=200*(b.upgrade+1); if(game.money<price) return; game.money-=price; b.upgrade++;}
function upStorage(i){let b=game.business[i]; let price=250*(b.storageLevel+1); if(game.money<price) return; game.money-=price; b.storageLevel++;}

//////////////// LOOP //////////////////

setInterval(()=>{

ecoTick();

// –±–∞–Ω–∫ –ø—Ä–æ—Ü–µ–Ω—Ç—ã
if(Date.now()%10000<1000) game.bank*=1.05;

game.business.forEach(b=>{
if(b.owned>0){
let max=b.owned*150*(b.storageLevel+1);
let add=b.owned*b.income*(b.upgrade+1)*game.eco;

if(b.stored<max){b.stored+=add*game.bonus;}
else{b.overflowTimer++; if(b.overflowTimer>5){b.stored*=0.8; b.overflowTimer=0;}}

if(b.manager && b.stored>0){game.money+=b.stored; b.stored=0;}
}
});

updateLevel();
update();
save();

},1000);

//////////////// UI //////////////////

function update(){
document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("safe").innerText=Math.floor(game.safe);
document.getElementById("bank").innerText=Math.floor(game.bank);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=game.bonus.toFixed(1);
document.getElementById("clickPower").innerText=game.clickPower.toFixed(1);

let d=document.getElementById("biz"); d.innerHTML="";
game.business.forEach((b,i)=>{
let max=b.owned*150*(b.storageLevel+1);
let percent=max>0?Math.min(100,(b.stored/max)*100):0;

d.innerHTML+=`
<div class="panel">
<b>${b.name}</b><br>
x${b.owned}<br>
–°–∫–ª–∞–¥: ${Math.floor(b.stored)} / ${max}
<div class="bar"><div class="fill" style="width:${percent}%"></div></div>
${b.overflowTimer>0?"‚è≥ –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ!":""}<br>
<button onclick="buy(${i})">–ö—É–ø–∏—Ç—å (${b.cost}$)</button>
<button class="blue" onclick="upIncome(${i})">–î–æ—Ö–æ–¥ (${200*(b.upgrade+1)}$)</button>
<button class="orange" onclick="upStorage(${i})">–°–∫–ª–∞–¥ (${250*(b.storageLevel+1)}$)</button>
${!b.manager?`<button onclick="collect(${i})">–°–æ–±—Ä–∞—Ç—å</button>
<button onclick="hire(${i})">–ú–µ–Ω–µ–¥–∂–µ—Ä (${500*(i+1)}$)</button>`:"üëî –ê–≤—Ç–æ —Å–±–æ—Ä"}
</div>`;
});
}

setEco("–°—Ç–∞–±–∏–ª—å–Ω–æ");
update();

</script>
</body>
</html>
clickPower:1,
level:1,
bonus:1,
economy:1,
crisisTimer:0,
bankMoney:0,
safeMoney:0,
business:[
{name:"–ö–∏–æ—Å–∫",cost:100,income:2,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ú–∞–≥–∞–∑–∏–Ω",cost:500,income:6,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–∞—Ñ–µ",cost:2000,income:15,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ó–∞–≤–æ–¥",cost:8000,income:40,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",cost:40000,income:120,owned:0,upgrade:0,manager:false,incomeAccum:0}
],
lastTime:Date.now()
};
let game;

// =================== LOAD / SAVE ===================
function save(){
game.lastTime = Date.now();
localStorage.setItem("beggarV50",JSON.stringify(game));
}

function load(){
let s = localStorage.getItem("beggarV50");
game = s ? Object.assign(structuredClone(baseGame), JSON.parse(s)) : structuredClone(baseGame);

let offlineSec = Math.floor((Date.now() - game.lastTime)/1000);
offlineSec = Math.min(offlineSec, 28800);

if(offlineSec>0){
game.business.forEach(b=>{
b.incomeAccum += offlineSec*b.owned*b.income;
});
alert("‚è≥ –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥ –Ω–∞–∫–æ–ø–ª–µ–Ω –≤ –±–∏–∑–Ω–µ—Å–∞—Ö!");
}
}

// =================== CLICK ===================
const clickBtn = document.getElementById("clickBtn");
clickBtn.addEventListener("click", ()=> {
game.money += game.clickPower*game.bonus;
updateLevel();
updateUI();
});

// =================== LEVEL ===================
function updateLevel(){
let lvl = Math.floor(Math.log10(game.money+1))+1;
if(lvl > game.level){
game.level = lvl;
game.bonus = 1 + (game.level-1)*0.1;
}
}

// =================== ECONOMY ===================
function economyTick(){
game.crisisTimer++;
if(game.crisisTimer>20){
game.crisisTimer = 0;
let r = Math.random();
if(r<0.25){
game.economy = 0.5;
setEconomyText("üí• –ö–†–ò–ó–ò–°");
game.business.forEach(b=>b.incomeAccum*=0.8);
} else if(r<0.5){
game.economy=0.8;
setEconomyText("üìâ –°–ø–∞–¥");
} else if(r<0.75){
game.economy=1.2;
setEconomyText("üìà –†–æ—Å—Ç");
} else {
game.economy=1.5;
setEconomyText("üöÄ –ë—É–º");
}}
}

function setEconomyText(text){
document.getElementById("economy").innerText = text;
}

// =================== BUSINESS ===================
function buyBiz(i){
let b = game.business[i];
if(game.money<b.cost) return;
game.money -= b.cost;
b.owned++;
b.cost = Math.floor(b.cost*1.5);
updateUI();
}

function upgradeBiz(i){
let b = game.business[i];
let price = b.cost*2;
if(game.money<price) return;
game.money -= price;
b.upgrade++;
updateUI();
}

function collectBiz(i){
let b = game.business[i];
game.money += Math.floor(b.incomeAccum*game.bonus*game.economy);
b.incomeAccum = 0;
updateUI();
}

function hireManager(i){
let b = game.business[i];
let price = b.cost*5;
if(game.money<price || b.manager) return;
game.money -= price;
b.manager = true;
updateUI();
}

function drawBiz(){
const d = document.getElementById("biz");
d.innerHTML="";
game.business.forEach((b,i)=>{
d.innerHTML+=`
<div class="panel">
<b>${b.name}</b><br>
–¶–µ–Ω–∞: ${b.cost}$<br>
–î–æ—Ö–æ–¥/—Å–µ–∫: ${b.income*(b.upgrade+1)}<br>
–í–ª–∞–¥–µ–Ω–∏–µ: x${b.owned}<br>
–ù–∞–∫–æ–ø–ª–µ–Ω–æ: ${Math.floor(b.incomeAccum)}$<br>
<button onclick="buyBiz(${i})">–ö—É–ø–∏—Ç—å</button>
<button class="blue" onclick="upgradeBiz(${i})">–ê–ø–≥—Ä–µ–π–¥ (${b.cost*2}$)</button><br>
<button class="green" onclick="collectBiz(${i})">–°–æ–±—Ä–∞—Ç—å</button>
<button class="blue" onclick="hireManager(${i})">${b.manager?"‚úÖ":"–ù–∞–Ω—è—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞"}</button>
</div>
`;
});

// =================== MANAGER TICK ===================
function managerTick(){
game.business.forEach(b=>{
if(b.manager){
b.incomeAccum += b.owned * b.income;
}});
}

// =================== BANK / SAFE ===================
function depositBank(){ if(game.money<=0) return; game.bankMoney+=game.money; game.money=0; updateUI(); }
function withdrawBank(){ if(game.bankMoney<=0) return; game.money+=game.bankMoney; game.bankMoney=0; updateUI(); }
function depositSafe(){ if(game.money<=0) return; game.safeMoney+=game.money; game.money=0; updateUI(); }
function withdrawSafe(){ if(game.safeMoney<=0) return; game.money+=game.safeMoney; game.safeMoney=0; updateUI(); }

// =================== UI ===================
function updateUI(){
document.getElementById("money").innerText = Math.floor(game.money);
document.getElementById("level").innerText = game.level;
document.getElementById("bonus").innerText = game.bonus.toFixed(1);
document.getElementById("bankMoney").innerText = Math.floor(game.bankMoney);
document.getElementById("safeMoney").innerText = Math.floor(game.safeMoney);
drawBiz();
save();
}

// =================== GAME LOOP ===================
setInterval(()=>{
managerTick();
economyTick();
game.money += game.bankMoney*0.001; // –±–∞–Ω–∫ –¥–∞—ë—Ç –ø—Ä–æ—Ü–µ–Ω—Ç—ã
updateLevel();
updateUI();
},1000);

// =================== START ===================
load();
setEconomyText("–°—Ç–∞–±–∏–ª—å–Ω–æ");
updateUI();
</script>
</body>
</html>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="biz"></div>
</div>

<div class="panel">
<h3>üëî –ú–µ–Ω–µ–¥–∂–µ—Ä—ã</h3>
<div id="managers"></div>
</div>

<script>
// –∞–Ω—Ç–∏-–∑—É–º
document.addEventListener('touchstart',e=>{
if(e.touches.length>1)e.preventDefault();
},{passive:false});

let lastTouchEnd=0;
document.addEventListener('touchend',e=>{
let now=Date.now();
if(now-lastTouchEnd<=300)e.preventDefault();
lastTouchEnd=now;
},false);

//////////////// BASE //////////////////
const baseGame={
money:0,
clickPower:1,
level:1,
bonus:1,
economy:1,
crisisTimer:0,
business:[
{name:"–ö–∏–æ—Å–∫",cost:100,income:2,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ú–∞–≥–∞–∑–∏–Ω",cost:500,income:6,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–∞—Ñ–µ",cost:2000,income:15,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ó–∞–≤–æ–¥",cost:8000,income:40,owned:0,upgrade:0,manager:false,incomeAccum:0},
{name:"–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",cost:40000,income:120,owned:0,upgrade:0,manager:false,incomeAccum:0}
],
lastTime:Date.now()
};

let game;

//////////////// CLICK //////////////////
function clickMoney(){
game.money+=game.clickPower*game.bonus;
updateLevel();
update();
}

//////////////// SAVE //////////////////
function save(){
game.lastTime=Date.now();
localStorage.setItem("beggarV46",JSON.stringify(game));
}

function load(){
let s=localStorage.getItem("beggarV46");
game=s
?Object.assign(structuredClone(baseGame),JSON.parse(s))
:structuredClone(baseGame);

let offlineSec=Math.floor((Date.now()-game.lastTime)/1000);
offlineSec=Math.min(offlineSec,28800);

if(offlineSec>0){
game.business.forEach(b=>{
b.incomeAccum += offlineSec * b.owned * b.income;
});
alert("‚è≥ –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥ –Ω–∞–∫–æ–ø–ª–µ–Ω –≤ –±–∏–∑–Ω–µ—Å–∞—Ö");
}
}

//////////////// LEVEL //////////////////
function updateLevel(){
let lvl=Math.floor(Math.log10(game.money+1))+1;
if(lvl>game.level){
game.level=lvl;
game.bonus=1+(game.level-1)*0.1;
}
}

//////////////// ECONOMY //////////////////
function economyTick(){
game.crisisTimer++;
if(game.crisisTimer>20){
game.crisisTimer=0;
let r=Math.random();
if(r<0.25){
game.economy=0.5;
setEconomyText("üí• –ö–†–ò–ó–ò–°");
game.business.forEach(b=>b.incomeAccum*=0.8); // —á–∞—Å—Ç—å –¥–æ—Ö–æ–¥–∞ —Ç–µ—Ä—è–µ—Ç—Å—è
}
else if(r<0.5){
game.economy=0.8;
setEconomyText("üìâ –°–ø–∞–¥");
}
else if(r<0.75){
game.economy=1.2;
setEconomyText("üìà –†–æ—Å—Ç");
}
else{
game.economy=1.5;
setEconomyText("üöÄ –ë—É–º");
}
}
}

function setEconomyText(text){
document.getElementById("economy").innerText=text;
}

//////////////// BUSINESS //////////////////
function buyBiz(i){
let b=game.business[i];
if(game.money<b.cost)return;
game.money-=b.cost;
b.owned++;
b.cost=Math.floor(b.cost*1.5);
}

function upgradeBiz(i){
let b=game.business[i];
let price=b.cost*2;
if(game.money<price)return;
game.money-=price;
b.upgrade++;
}

function collectBiz(i){
let b=game.business[i];
game.money += Math.floor(b.incomeAccum * game.bonus * game.economy);
b.incomeAccum = 0;
update();
}

function drawBiz(){
let d=document.getElementById("biz");
d.innerHTML="";
game.business.forEach((b,i)=>{
d.innerHTML+=`
<div class="panel">
<b>${b.name}</b><br>
–¶–µ–Ω–∞: ${b.cost}$<br>
–î–æ—Ö–æ–¥ –∑–∞ —Å–µ–∫: ${b.income*(b.upgrade+1)}<br>
–í–ª–∞–¥–µ–Ω–∏–µ: x${b.owned}<br>
–ù–∞–∫–æ–ø–ª–µ–Ω–æ: ${Math.floor(b.incomeAccum)}$<br>
<button onclick="buyBiz(${i})">–ö—É–ø–∏—Ç—å</button>
<button class="blue" onclick="upgradeBiz(${i})">–ê–ø–≥—Ä–µ–π–¥ (${b.cost*2}$)</button><br>
<button class="green" onclick="collectBiz(${i})">–°–æ–±—Ä–∞—Ç—å</button>
<button class="blue" onclick="hireManager(${i})">${b.manager?"‚úÖ":"–ù–∞–Ω—è—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞"}</button>
</div>
`;
});
}

//////////////// MANAGERS //////////////////
function hireManager(i){
let b=game.business[i];
let price=b.cost*5;
if(game.money<price||b.manager)return;
game.money-=price;
b.manager=true;
update();
}

function managerTick(){
game.business.forEach(b=>{
if(b.manager){
b.incomeAccum += b.owned * b.income;
}
});
}

//////////////// LOOP //////////////////
setInterval(()=>{
managerTick();
economyTick();
updateLevel();
update();
},1000);

//////////////// UI //////////////////
function update(){
document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=game.bonus.toFixed(1);
drawBiz();
save();
}

//////////////// START //////////////////
load();
setEconomyText("–°—Ç–∞–±–∏–ª—å–Ω–æ");
update();
</script>
</body>
</html>
<button class="green" onclick="clickMoney()">–ö–ª–∏–∫</button>

<div class="panel">
<h3>üè¶ –ë–∞–Ω–∫ –∏ —Å–µ–π—Ñ</h3>
üíµ –í –±–∞–Ω–∫–µ: <span id="bankMoney">0</span>$<br>
üí∞ –í —Å–µ–π—Ñ–µ: <span id="safeMoney">0</span>$<br>
<button class="green" onclick="depositBank()">–ü–æ–ª–æ–∂–∏—Ç—å –≤ –±–∞–Ω–∫</button>
<button class="blue" onclick="withdrawBank()">–ó–∞–±—Ä–∞—Ç—å –∏–∑ –±–∞–Ω–∫–∞</button><br>
<button class="green" onclick="depositSafe()">–ü–æ–ª–æ–∂–∏—Ç—å –≤ —Å–µ–π—Ñ</button>
<button class="blue" onclick="withdrawSafe()">–ó–∞–±—Ä–∞—Ç—å –∏–∑ —Å–µ–π—Ñ–∞</button>
</div>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="biz"></div>
</div>

<div class="panel">
<h3>üëî –ú–µ–Ω–µ–¥–∂–µ—Ä—ã</h3>
<div id="managers"></div>
</div>

<script>
// –∞–Ω—Ç–∏-–∑—É–º
document.addEventListener('touchstart',e=>{
if(e.touches.length>1)e.preventDefault();
},{passive:false});

let lastTouchEnd=0;
document.addEventListener('touchend',e=>{
let now=Date.now();
if(now-lastTouchEnd<=300)e.preventDefault();
lastTouchEnd=now;
},false);

//////////////// BASE //////////////////
const baseGame={
money:0,
income:0,
clickPower:1,
level:1,
bonus:1,
economy:1,
crisisTimer:0,
bankMoney:0,
safeMoney:0,
business:[
{name:"–ö–∏–æ—Å–∫",cost:100,income:2,owned:0,upgrade:0,manager:false},
{name:"–ú–∞–≥–∞–∑–∏–Ω",cost:500,income:6,owned:0,upgrade:0,manager:false},
{name:"–ö–∞—Ñ–µ",cost:2000,income:15,owned:0,upgrade:0,manager:false},
{name:"–ó–∞–≤–æ–¥",cost:8000,income:40,owned:0,upgrade:0,manager:false},
{name:"–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",cost:40000,income:120,owned:0,upgrade:0,manager:false}
],
lastTime:Date.now()
};

let game;

//////////////// CLICK //////////////////
function clickMoney(){
game.money+=game.clickPower*game.bonus;
updateLevel();
update();
}

//////////////// SAVE //////////////////
function save(){
game.lastTime=Date.now();
localStorage.setItem("beggarV45",JSON.stringify(game));
}

function load(){
let s=localStorage.getItem("beggarV45");
game=s
?Object.assign(structuredClone(baseGame),JSON.parse(s))
:structuredClone(baseGame);
recalcIncome();

let offlineSec=Math.floor((Date.now()-game.lastTime)/1000);
offlineSec=Math.min(offlineSec,28800);

if(offlineSec>0){
let earn=offlineSec*game.income*game.bonus*game.economy;
game.money+=earn;
alert("‚è≥ –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥: +"+Math.floor(earn)+"$");
}
}

//////////////// INCOME //////////////////
function recalcIncome(){
let total=0;
game.business.forEach(b=>{
total+=b.owned*b.income*(b.upgrade+1);
});
game.income=total;
}

//////////////// LEVEL //////////////////
function updateLevel(){
let lvl=Math.floor(Math.log10(game.money+1))+1;
if(lvl>game.level){
game.level=lvl;
game.bonus=1+(game.level-1)*0.1;
}
}

//////////////// ECONOMY //////////////////
function economyTick(){
game.crisisTimer++;
if(game.crisisTimer>20){
game.crisisTimer=0;
let r=Math.random();
if(r<0.25){
game.economy=0.5;
setEconomyText("üí• –ö–†–ò–ó–ò–°");
game.money*=0.8; // —Ç–µ—Ä—è–µ–º —á–∞—Å—Ç—å –¥–µ–Ω–µ–≥ –ø—Ä–∏ –∫—Ä–∏–∑–∏—Å–µ, —Å–µ–π—Ñ –∑–∞—â–∏—â–∞–µ—Ç
}
else if(r<0.5){
game.economy=0.8;
setEconomyText("üìâ –°–ø–∞–¥");
}
else if(r<0.75){
game.economy=1.2;
setEconomyText("üìà –†–æ—Å—Ç");
}
else{
game.economy=1.5;
setEconomyText("üöÄ –ë—É–º");
}
}
}

function setEconomyText(text){
document.getElementById("economy").innerText=text;
}

//////////////// BUSINESS //////////////////
function buyBiz(i){
let b=game.business[i];
if(game.money<b.cost)return;
game.money-=b.cost;
b.owned++;
b.cost=Math.floor(b.cost*1.5);
recalcIncome();
}

function upgradeBiz(i){
let b=game.business[i];
let price=b.cost*2;
if(game.money<price)return;
game.money-=price;
b.upgrade++;
recalcIncome();
}

function drawBiz(){
let d=document.getElementById("biz");
d.innerHTML="";
game.business.forEach((b,i)=>{
d.innerHTML+=`
<div class="panel">
<b>${b.name}</b><br>
–¶–µ–Ω–∞: ${b.cost}$<br>
–î–æ—Ö–æ–¥: ${b.income*(b.upgrade+1)}<br>
–í–ª–∞–¥–µ–Ω–∏–µ: x${b.owned}<br>
–ê–ø–≥—Ä–µ–π–¥: ${b.upgrade}<br>
<button onclick="buyBiz(${i})">–ö—É–ø–∏—Ç—å</button>
<button class="blue" onclick="upgradeBiz(${i})">
–ê–ø–≥—Ä–µ–π–¥ (${b.cost*2}$)
</button>
</div>
`;
});
}

//////////////// MANAGERS //////////////////
function hireManager(i){
let b=game.business[i];
let price=b.cost*5;
if(game.money<price||b.manager)return;
game.money-=price;
b.manager=true;
}

function managerTick(){
game.business.forEach((b,i)=>{
if(b.manager && game.money>=b.cost){
buyBiz(i);
}
});
}

function drawManagers(){
let d=document.getElementById("managers");
d.innerHTML="";
game.business.forEach((b,i)=>{
d.innerHTML+=`
<button onclick="hireManager(${i})">
${b.name}: ${b.manager?"‚úÖ":"–ù–∞–Ω—è—Ç—å ("+b.cost*5+"$)"}
</button><br>
`;
});
}

//////////////// BANK & SAFE //////////////////
function depositBank(){
if(game.money<=0) return;
game.bankMoney += game.money;
game.money = 0;
updateBankUI();
}

function withdrawBank(){
if(game.bankMoney<=0) return;
game.money += game.bankMoney;
game.bankMoney = 0;
updateBankUI();
}

function depositSafe(){
if(game.money<=0) return;
game.safeMoney += game.money;
game.money = 0;
updateBankUI();
}

function withdrawSafe(){
if(game.safeMoney<=0) return;
game.money += game.safeMoney;
game.safeMoney = 0;
updateBankUI();
}

function updateBankUI(){
document.getElementById("bankMoney").innerText = Math.floor(game.bankMoney);
document.getElementById("safeMoney").innerText = Math.floor(game.safeMoney);
}

//////////////// LOOP //////////////////
setInterval(()=>{
managerTick();
economyTick();
game.money+=game.income*game.bonus*game.economy + game.bankMoney*0.001; // –±–∞–Ω–∫ –¥–∞—ë—Ç –ø—Ä–æ—Ü–µ–Ω—Ç—ã
updateLevel();
update();
},1000);

//////////////// UI //////////////////
function update(){
document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("income").innerText=Math.floor(game.income*game.bonus*game.economy);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=game.bonus.toFixed(1);

drawBiz();
drawManagers();
updateBankUI();
save();
}

//////////////// START //////////////////
load();
setEconomyText("–°—Ç–∞–±–∏–ª—å–Ω–æ");
update();
</script>
</body>
</html>
.blue{background:#3498db}
.orange{background:#e67e22}
.red{background:#e74c3c}

.bar{
height:10px;
background:#333;
border-radius:6px;
overflow:hidden;
margin:4px 0;
}

.fill{
height:100%;
background:#2ecc71;
}
</style>
</head>
<body>

<h2>üî• –ö–ª–∏–∫–µ—Ä –ë–æ–º–∂–∞ PRO 4.5 EVOLUTION v2</h2>

<div class="panel">
üí∞ –ù–∞–ª–∏—á–Ω—ã–µ: <span id="money"></span><br>
üí∞ –°–µ–π—Ñ: <span id="safe"></span><br>
üè¶ –ë–∞–Ω–∫: <span id="bank"></span><br>
‚≠ê –£—Ä–æ–≤–µ–Ω—å: <span id="level"></span><br>
‚ö° –ë–æ–Ω—É—Å: x<span id="bonus"></span><br>
üñ±Ô∏è –°–∏–ª–∞ –∫–ª–∏–∫–∞: x<span id="clickPower"></span><br>
üåç –≠–∫–æ–Ω–æ–º–∏–∫–∞: <span id="eco"></span>
</div>

<button class="green" id="clickBtn">–ö–ª–∏–∫</button>
<button onclick="moveSafe()">–í —Å–µ–π—Ñ</button>
<button onclick="moveBank()">–í –±–∞–Ω–∫</button>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="biz"></div>
</div>

<script>

// ‚úÖ –ê–ù–¢–ò-–ó–£–ú
document.addEventListener('touchstart', e => { if(e.touches.length>1) e.preventDefault(); }, {passive:false});
let lastTouchEnd=0;
document.addEventListener('touchend', e => { 
let now=Date.now(); 
if(now-lastTouchEnd<=300) e.preventDefault(); 
lastTouchEnd=now; 
}, false);

//////////////// –ò–ì–†–ê //////////////////

const baseGame={
money:0,
safe:0,
bank:0,
level:1,
bonus:1,
clickPower:1,
eco:1,
ecoTimer:0,
business:[]
};

const names=[
"–ö–∏–æ—Å–∫","–ú–∞–≥–∞–∑–∏–Ω","–ö–∞—Ñ–µ","–ó–∞–≤–æ–¥","–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",
"–¢–¶","IT —Ñ–∏—Ä–º–∞","–ù–µ—Ñ—Ç–µ–≤—ã—à–∫–∞","–ê—ç—Ä–æ–ø–æ—Ä—Ç","–ö–∞–∑–∏–Ω–æ",
"–ë–∞–Ω–∫","–ó–∞–≤–æ–¥ –¥—Ä–æ–Ω–æ–≤","–ö—Ä–∏–ø—Ç–æ—Ñ–µ—Ä–º–∞","–ö–æ—Å–º–æ–¥—Ä–æ–º","–•–æ–ª–¥–∏–Ω–≥"
];

names.forEach((n,i)=>{
baseGame.business.push({
name:n,
cost:100*Math.pow(3,i),
income:2*Math.pow(2,i),
owned:0,
upgrade:0,
storageLevel:0,
stored:0,
overflowTimer:0,
manager:false
});
});

let game=JSON.parse(localStorage.getItem("beggar45ev2"))||structuredClone(baseGame);

//////////////// SAVE //////////////////

function save(){localStorage.setItem("beggar45ev2",JSON.stringify(game));}

//////////////// –ö–õ–ò–ö //////////////////

const clickBtn=document.getElementById("clickBtn");
clickBtn.addEventListener('click',()=>{

let gain=game.clickPower*game.bonus*game.eco;
game.money+=gain;

// –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –∫–ª–∏–∫–∞
clickBtn.style.transform="scale(1.2)";
setTimeout(()=>{clickBtn.style.transform="scale(1)";},80);

updateLevel();
update();
});

//////////////// SAFE / BANK //////////////////

function moveSafe(){game.safe+=game.money; game.money=0;}
function moveBank(){game.bank+=game.money; game.money=0;}

//////////////// LEVEL //////////////////

function updateLevel(){
let total=game.money+game.safe+game.bank;
let lvl=Math.floor(Math.log10(total+1))+1;
if(lvl>game.level){game.level=lvl; game.bonus=1+(game.level-1)*0.1;}
}

//////////////// ECONOMY //////////////////

function ecoTick(){
game.ecoTimer++;
if(game.ecoTimer>20){
game.ecoTimer=0;
let r=Math.random();
if(r<0.25){game.eco=0.6; setEco("üí• –ö—Ä–∏–∑–∏—Å")}
else if(r<0.5){game.eco=0.8; setEco("üìâ –°–ø–∞–¥")}
else if(r<0.75){game.eco=1.2; setEco("üìà –†–æ—Å—Ç")}
else{game.eco=1.5; setEco("üöÄ –ë—É–º")}
}
}
function setEco(t){document.getElementById("eco").innerText=t;}

//////////////// BUSINESS //////////////////

function buy(i){let b=game.business[i]; if(game.money<b.cost) return; game.money-=b.cost; b.owned++; b.cost=Math.floor(b.cost*1.4);}
function collect(i){let b=game.business[i]; game.money+=b.stored; b.stored=0; b.overflowTimer=0;}
function hire(i){let b=game.business[i]; let price=500*(i+1); if(game.money<price||b.manager) return; game.money-=price; b.manager=true;}
function upIncome(i){let b=game.business[i]; let price=200*(b.upgrade+1); if(game.money<price) return; game.money-=price; b.upgrade++;}
function upStorage(i){let b=game.business[i]; let price=250*(b.storageLevel+1); if(game.money<price) return; game.money-=price; b.storageLevel++;}

//////////////// LOOP //////////////////

setInterval(()=>{

ecoTick();

// –±–∞–Ω–∫ –ø—Ä–æ—Ü–µ–Ω—Ç—ã
if(Date.now()%10000<1000) game.bank*=1.05;

game.business.forEach(b=>{
if(b.owned>0){
let max=b.owned*150*(b.storageLevel+1);
let add=b.owned*b.income*(b.upgrade+1)*game.eco;

if(b.stored<max){b.stored+=add*game.bonus;}
else{b.overflowTimer++; if(b.overflowTimer>5){b.stored*=0.8; b.overflowTimer=0;}}

if(b.manager && b.stored>0){game.money+=b.stored; b.stored=0;}
}
});

updateLevel();
update();
save();

},1000);

//////////////// UI //////////////////

function update(){

document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("safe").innerText=Math.floor(game.safe);
document.getElementById("bank").innerText=Math.floor(game.bank);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=game.bonus.toFixed(1);
document.getElementById("clickPower").innerText=game.clickPower.toFixed(1);

let d=document.getElementById("biz"); d.innerHTML="";

game.business.forEach((b,i)=>{
let max=b.owned*150*(b.storageLevel+1);
let percent=max>0?Math.min(100,(b.stored/max)*100):0;
d.innerHTML+=`
<div class="panel">
<b>${b.name}</b><br>
x${b.owned}<br>
–°–∫–ª–∞–¥: ${Math.floor(b.stored)} / ${max}
<div class="bar"><div class="fill" style="width:${percent}%"></div></div>
${b.overflowTimer>0?"‚è≥ –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ!":""}<br>
<button onclick="buy(${i})">–ö—É–ø–∏—Ç—å (${b.cost}$)</button>
<button class="blue" onclick="upIncome(${i})">–î–æ—Ö–æ–¥ (${200*(b.upgrade+1)}$)</button>
<button class="orange" onclick="upStorage(${i})">–°–∫–ª–∞–¥ (${250*(b.storageLevel+1)}$)</button>
${!b.manager?`<button onclick="collect(${i})">–°–æ–±—Ä–∞—Ç—å</button>
<button onclick="hire(${i})">–ú–µ–Ω–µ–¥–∂–µ—Ä (${500*(i+1)}$)</button>`:"üëî –ê–≤—Ç–æ —Å–±–æ—Ä"}
</div>`;
});
}

setEco("–°—Ç–∞–±–∏–ª—å–Ω–æ");
update();

</script>
</body>
</html>

.bar{
height:10px;
background:#333;
border-radius:6px;
overflow:hidden;
margin:4px 0;
}

.fill{
height:100%;
background:#2ecc71;
}
</style>
</head>
<body>

<h2>üî• –ö–ª–∏–∫–µ—Ä –ë–æ–º–∂–∞ PRO 4.5 EVOLUTION</h2>

<div class="panel">
üí∞ –ù–∞–ª–∏—á–Ω—ã–µ: <span id="money"></span><br>
üí∞ –°–µ–π—Ñ: <span id="safe"></span><br>
üè¶ –ë–∞–Ω–∫: <span id="bank"></span><br>
‚≠ê –£—Ä–æ–≤–µ–Ω—å: <span id="level"></span><br>
‚ö° –ë–æ–Ω—É—Å: x<span id="bonus"></span><br>
üåç –≠–∫–æ–Ω–æ–º–∏–∫–∞: <span id="eco"></span>
</div>

<button class="green" onclick="clickMoney()">–ö–ª–∏–∫</button>
<button onclick="moveSafe()">–í —Å–µ–π—Ñ</button>
<button onclick="moveBank()">–í –±–∞–Ω–∫</button>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="biz"></div>
</div>

<script>

const baseGame={
money:0,
safe:0,
bank:0,
level:1,
bonus:1,
economy:1,
ecoTimer:0,

business:[]
};

const names=[
"–ö–∏–æ—Å–∫","–ú–∞–≥–∞–∑–∏–Ω","–ö–∞—Ñ–µ","–ó–∞–≤–æ–¥","–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",
"–¢–¶","IT —Ñ–∏—Ä–º–∞","–ù–µ—Ñ—Ç–µ–≤—ã—à–∫–∞","–ê—ç—Ä–æ–ø–æ—Ä—Ç","–ö–∞–∑–∏–Ω–æ",
"–ë–∞–Ω–∫","–ó–∞–≤–æ–¥ –¥—Ä–æ–Ω–æ–≤","–ö—Ä–∏–ø—Ç–æ—Ñ–µ—Ä–º–∞","–ö–æ—Å–º–æ–¥—Ä–æ–º","–•–æ–ª–¥–∏–Ω–≥"
];

names.forEach((n,i)=>{
baseGame.business.push({
name:n,
cost:100*Math.pow(3,i),
income:2*Math.pow(2,i),
owned:0,
upgrade:0,
storageLevel:0,
stored:0,
overflowTimer:0,
manager:false
});
});

let game=JSON.parse(localStorage.getItem("beggar45e"))||structuredClone(baseGame);

//////////////// SAVE //////////////////

function save(){
localStorage.setItem("beggar45e",JSON.stringify(game));
}

//////////////// CLICK //////////////////

function clickMoney(){
game.money+=1*game.bonus;
updateLevel();
}

//////////////// SAFE / BANK //////////////////

function moveSafe(){
game.safe+=game.money;
game.money=0;
}

function moveBank(){
game.bank+=game.money;
game.money=0;
}

//////////////// LEVEL //////////////////

function updateLevel(){
let total=game.money+game.safe+game.bank;
let lvl=Math.floor(Math.log10(total+1))+1;
if(lvl>game.level){
game.level=lvl;
game.bonus=1+(game.level-1)*0.1;
}
}

//////////////// ECONOMY //////////////////

function ecoTick(){
game.ecoTimer++;
if(game.ecoTimer>20){
game.ecoTimer=0;
let r=Math.random();

if(r<0.25){game.economy=0.6;setEco("üí• –ö—Ä–∏–∑–∏—Å")}
else if(r<0.5){game.economy=0.8;setEco("üìâ –°–ø–∞–¥")}
else if(r<0.75){game.economy=1.2;setEco("üìà –†–æ—Å—Ç")}
else{game.economy=1.5;setEco("üöÄ –ë—É–º")}
}
}

function setEco(t){
document.getElementById("eco").innerText=t;
}

//////////////// BUSINESS //////////////////

function buy(i){
let b=game.business[i];
if(game.money<b.cost)return;
game.money-=b.cost;
b.owned++;
b.cost=Math.floor(b.cost*1.4);
}

function collect(i){
let b=game.business[i];
game.money+=b.stored;
b.stored=0;
b.overflowTimer=0;
}

function hire(i){
let b=game.business[i];
let price=500*(i+1);
if(game.money<price||b.manager)return;
game.money-=price;
b.manager=true;
}

function upIncome(i){
let b=game.business[i];
let price=200*(b.upgrade+1);
if(game.money<price)return;
game.money-=price;
b.upgrade++;
}

function upStorage(i){
let b=game.business[i];
let price=250*(b.storageLevel+1);
if(game.money<price)return;
game.money-=price;
b.storageLevel++;
}

//////////////// LOOP //////////////////

setInterval(()=>{

ecoTick();

// –ø—Ä–æ—Ü–µ–Ω—Ç—ã –±–∞–Ω–∫–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫
if(Date.now()%10000<1000){
game.bank*=1.05;
}

game.business.forEach(b=>{

if(b.owned>0){

let max=b.owned*150*(b.storageLevel+1);
let add=b.owned*b.income*(b.upgrade+1)*game.economy;

if(b.stored<max){
b.stored+=add*game.bonus;
}
else{
b.overflowTimer++;
if(b.overflowTimer>5){
b.stored*=0.8;
b.overflowTimer=0;
}
}

if(b.manager && b.stored>0){
game.money+=b.stored;
b.stored=0;
}
}
});

updateLevel();
update();
save();

},1000);

//////////////// UI //////////////////

function update(){

document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("safe").innerText=Math.floor(game.safe);
document.getElementById("bank").innerText=Math.floor(game.bank);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=game.bonus.toFixed(1);

let d=document.getElementById("biz");
d.innerHTML="";

game.business.forEach((b,i)=>{

let max=b.owned*150*(b.storageLevel+1);
let percent=max>0?Math.min(100,(b.stored/max)*100):0;

d.innerHTML+=`
<div class="panel">
<b>${b.name}</b><br>
x${b.owned}<br>
–°–∫–ª–∞–¥: ${Math.floor(b.stored)} / ${max}

<div class="bar">
<div class="fill" style="width:${percent}%"></div>
</div>

${b.overflowTimer>0?"‚è≥ –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ!":""}

<br>

<button onclick="buy(${i})">–ö—É–ø–∏—Ç—å (${b.cost}$)</button>
<button class="blue" onclick="upIncome(${i})">
–î–æ—Ö–æ–¥ (${200*(b.upgrade+1)}$)
</button>
<button class="orange" onclick="upStorage(${i})">
–°–∫–ª–∞–¥ (${250*(b.storageLevel+1)}$)
</button>

${!b.manager?
`<button onclick="collect(${i})">–°–æ–±—Ä–∞—Ç—å</button>
<button onclick="hire(${i})">
–ú–µ–Ω–µ–¥–∂–µ—Ä (${500*(i+1)}$)
</button>`
:"üëî –ê–≤—Ç–æ —Å–±–æ—Ä"}

</div>
`;
});

}

setEco("–°—Ç–∞–±–∏–ª—å–Ω–æ");
update();

</script>
</body>
</html>
‚≠ê –£—Ä–æ–≤–µ–Ω—å: <span id="level"></span><br>
‚ö° –ë–æ–Ω—É—Å: x<span id="bonus"></span><br>
üåç –≠–∫–æ–Ω–æ–º–∏–∫–∞: <span id="economy"></span>
</div>

<button class="green" onclick="clickMoney()">–ö–ª–∏–∫</button>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="biz"></div>
</div>

<div class="panel">
<h3>üëî –ú–µ–Ω–µ–¥–∂–µ—Ä—ã</h3>
<div id="managers"></div>
</div>

<script>

/* –∞–Ω—Ç–∏-–∑—É–º */
document.addEventListener('touchstart',e=>{
if(e.touches.length>1)e.preventDefault();
},{passive:false});

let lastTouchEnd=0;
document.addEventListener('touchend',e=>{
let now=Date.now();
if(now-lastTouchEnd<=300)e.preventDefault();
lastTouchEnd=now;
},false);

//////////////// BASE //////////////////

const baseGame={
money:0,
income:0,
clickPower:1,
level:1,
bonus:1,
economy:1,
crisisTimer:0,

business:[
{name:"–ö–∏–æ—Å–∫",cost:100,income:2,owned:0,upgrade:0,manager:false},
{name:"–ú–∞–≥–∞–∑–∏–Ω",cost:500,income:6,owned:0,upgrade:0,manager:false},
{name:"–ö–∞—Ñ–µ",cost:2000,income:15,owned:0,upgrade:0,manager:false},
{name:"–ó–∞–≤–æ–¥",cost:8000,income:40,owned:0,upgrade:0,manager:false},
{name:"–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",cost:40000,income:120,owned:0,upgrade:0,manager:false}
],

lastTime:Date.now()
};

let game;

//////////////// CLICK //////////////////

function clickMoney(){
game.money+=game.clickPower*game.bonus;
updateLevel();
update();
}

//////////////// SAVE //////////////////

function save(){
game.lastTime=Date.now();
localStorage.setItem("beggarV44",JSON.stringify(game));
}

function load(){
let s=localStorage.getItem("beggarV44");

game=s
?Object.assign(structuredClone(baseGame),JSON.parse(s))
:structuredClone(baseGame);

recalcIncome();

let offlineSec=Math.floor((Date.now()-game.lastTime)/1000);
offlineSec=Math.min(offlineSec,28800);

if(offlineSec>0){
let earn=offlineSec*
game.income*
game.bonus*
game.economy;

game.money+=earn;
alert("‚è≥ –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥: +"+Math.floor(earn)+"$");
}
}

//////////////// INCOME //////////////////

function recalcIncome(){
let total=0;

game.business.forEach(b=>{
total+=b.owned*b.income*(b.upgrade+1);
});

game.income=total;
}

//////////////// LEVEL //////////////////

function updateLevel(){
let lvl=Math.floor(Math.log10(game.money+1))+1;

if(lvl>game.level){
game.level=lvl;
game.bonus=1+(game.level-1)*0.1;
}
}

//////////////// ECONOMY //////////////////

function economyTick(){

game.crisisTimer++;

if(game.crisisTimer>20){

game.crisisTimer=0;
let r=Math.random();

if(r<0.25){
game.economy=0.5;
setEconomyText("üí• –ö–†–ò–ó–ò–°");
}
else if(r<0.5){
game.economy=0.8;
setEconomyText("üìâ –°–ø–∞–¥");
}
else if(r<0.75){
game.economy=1.2;
setEconomyText("üìà –†–æ—Å—Ç");
}
else{
game.economy=1.5;
setEconomyText("üöÄ –ë—É–º");
}
}
}

function setEconomyText(text){
document.getElementById("economy").innerText=text;
}

//////////////// BUSINESS //////////////////

function buyBiz(i){
let b=game.business[i];
if(game.money<b.cost)return;

game.money-=b.cost;
b.owned++;
b.cost=Math.floor(b.cost*1.5);

recalcIncome();
}

function upgradeBiz(i){
let b=game.business[i];
let price=b.cost*2;

if(game.money<price)return;

game.money-=price;
b.upgrade++;

recalcIncome();
}

function drawBiz(){
let d=document.getElementById("biz");
d.innerHTML="";

game.business.forEach((b,i)=>{

d.innerHTML+=`
<div class="panel">
<b>${b.name}</b><br>
–¶–µ–Ω–∞: ${b.cost}$<br>
–î–æ—Ö–æ–¥: ${b.income*(b.upgrade+1)}<br>
–í–ª–∞–¥–µ–Ω–∏–µ: x${b.owned}<br>
–ê–ø–≥—Ä–µ–π–¥: ${b.upgrade}<br>
<button onclick="buyBiz(${i})">–ö—É–ø–∏—Ç—å</button>
<button class="blue" onclick="upgradeBiz(${i})">
–ê–ø–≥—Ä–µ–π–¥ (${b.cost*2}$)
</button>
</div>
`;
});
}

//////////////// MANAGERS //////////////////

function hireManager(i){
let b=game.business[i];
let price=b.cost*5;

if(game.money<price||b.manager)return;

game.money-=price;
b.manager=true;
}

function managerTick(){
game.business.forEach((b,i)=>{
if(b.manager && game.money>=b.cost){
buyBiz(i);
}
});
}

function drawManagers(){
let d=document.getElementById("managers");
d.innerHTML="";

game.business.forEach((b,i)=>{

d.innerHTML+=`
<button onclick="hireManager(${i})">
${b.name}: ${b.manager?"‚úÖ":"–ù–∞–Ω—è—Ç—å ("+b.cost*5+"$)"}
</button><br>
`;
});
}

//////////////// LOOP //////////////////

setInterval(()=>{

managerTick();
economyTick();

game.money+=game.income*game.bonus*game.economy;

updateLevel();
update();

},1000);

//////////////// UI //////////////////

function update(){

document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("income").innerText=
Math.floor(game.income*game.bonus*game.economy);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=
game.bonus.toFixed(1);

drawBiz();
drawManagers();
save();
}

//////////////// START //////////////////

load();
setEconomyText("–°—Ç–∞–±–∏–ª—å–Ω–æ");
update();

</script>
</body>
</html>
<body>

<h2>üî• –ö–ª–∏–∫–µ—Ä –ë–æ–º–∂–∞ PRO 4.3 (FIXED)</h2>

<div class="panel">
üí∞ –î–µ–Ω—å–≥–∏: <span id="money"></span><br>
üè¢ –î–æ—Ö–æ–¥/—Å–µ–∫: <span id="income"></span><br>
‚≠ê –£—Ä–æ–≤–µ–Ω—å: <span id="level"></span><br>
‚ö° –ë–æ–Ω—É—Å: x<span id="bonus"></span><br>
üåç –≠–∫–æ–Ω–æ–º–∏–∫–∞: <span id="economy"></span>
</div>

<button class="green" onclick="clickMoney()">–ö–ª–∏–∫</button>

<div class="panel">
<h3>üè¢ –ë–∏–∑–Ω–µ—Å</h3>
<div id="biz"></div>
</div>

<div class="panel">
<h3>üëî –ú–µ–Ω–µ–¥–∂–µ—Ä—ã</h3>
<div id="managers"></div>
</div>

<script>

/* ‚úÖ JS –∞–Ω—Ç–∏-–∑—É–º (–¥–≤–æ–π–Ω–æ–π —Ç–∞–ø) */
document.addEventListener('touchstart',e=>{
if(e.touches.length>1)e.preventDefault();
},{passive:false});

let lastTouchEnd=0;
document.addEventListener('touchend',e=>{
let now=Date.now();
if(now-lastTouchEnd<=300)e.preventDefault();
lastTouchEnd=now;
},false);

//////////////// BASE //////////////////

const baseGame={
money:0,
income:0,
clickPower:1,
level:1,
bonus:1,
economy:1,
crisisTimer:0,

business:[
{name:"–ö–∏–æ—Å–∫",cost:100,income:2,owned:0,upgrade:0,manager:false},
{name:"–ú–∞–≥–∞–∑–∏–Ω",cost:500,income:6,owned:0,upgrade:0,manager:false},
{name:"–ö–∞—Ñ–µ",cost:2000,income:15,owned:0,upgrade:0,manager:false},
{name:"–ó–∞–≤–æ–¥",cost:8000,income:40,owned:0,upgrade:0,manager:false},
{name:"–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è",cost:40000,income:120,owned:0,upgrade:0,manager:false}
],

lastTime:Date.now()
};

let game;

//////////////// SAVE //////////////////

function save(){
game.lastTime=Date.now();
localStorage.setItem("beggarV43",JSON.stringify(game));
}

function load(){
let s=localStorage.getItem("beggarV43");
game=s?Object.assign(structuredClone(baseGame),JSON.parse(s))
:structuredClone(baseGame);

recalcIncome();

let offlineSec=Math.floor((Date.now()-game.lastTime)/1000);
offlineSec=Math.min(offlineSec,28800);

if(offlineSec>0){
let earn=offlineSec*
game.income*
game.bonus*
game.economy;

game.money+=earn;
alert("‚è≥ –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥: +"+Math.floor(earn)+"$");
}
}

//////////////// INCOME //////////////////

function recalcIncome(){
let total=0
update();
}

//////////////// LEVEL //////////////////

function updateLevel(){
let lvl=Math.floor(Math.log10(game.money+1))+1;
if(lvl>game.level){
game.level=lvl;
game.bonus=1+(game.level-1)*0.1;
}
}

//////////////// ECONOMY //////////////////

function economyTick(){

game.crisisTimer++;

if(game.crisisTimer>20){

game.crisisTimer=0;

let r=Math.random();

if(r<0.25){
game.economy=0.5;
setEconomyText("üí• –ö–†–ò–ó–ò–°");
}
else if(r<0.5){
game.economy=0.8;
setEconomyText("üìâ –°–ø–∞–¥");
}
else if(r<0.75){
game.economy=1.2;
setEconomyText("üìà –†–æ—Å—Ç");
}
else{
game.economy=1.5;
setEconomyText("üöÄ –ë—É–º");
}
}
}

function setEconomyText(text){
document.getElementById("economy").innerText=text;
}

//////////////// BUSINESS //////////////////

function buyBiz(i){
let b=game.business[i];
if(game.money<b.cost)return;

game.money-=b.cost;
b.owned++;

game.income+=b.income*(b.upgrade+1);
b.cost=Math.floor(b.cost*1.5);
}

function upgradeBiz(i){
let b=game.business[i];
let price=b.cost*2;

if(game.money<price)return;

game.money-=price;
b.upgrade++;

game.income+=b.income;
}

function drawBiz(){
let d=document.getElementById("biz");
d.innerHTML="";

game.business.forEach((b,i)=>{

d.innerHTML+=`
<div class="panel">
<b>${b.name}</b><br>
–¶–µ–Ω–∞: ${b.cost}$<br>
–î–æ—Ö–æ–¥: ${b.income*(b.upgrade+1)}<br>
–í–ª–∞–¥–µ–Ω–∏–µ: x${b.owned}<br>
–ê–ø–≥—Ä–µ–π–¥: ${b.upgrade}
<br>
<button onclick="buyBiz(${i})">–ö—É–ø–∏—Ç—å</button>
<button class="blue" onclick="upgradeBiz(${i})">
–ê–ø–≥—Ä–µ–π–¥ (${b.cost*2}$)
</button>
</div>
`;
});
}

//////////////// MANAGERS //////////////////

function hireManager(i){
let b=game.business[i];
let price=b.cost*5;

if(game.money<price||b.manager)return;

game.money-=price;
b.manager=true;
}

function managerTick(){
game.business.forEach((b,i)=>{
if(b.manager && game.money>=b.cost){
buyBiz(i);
}
});
}

function drawManagers(){
let d=document.getElementById("managers");
d.innerHTML="";

game.business.forEach((b,i)=>{

d.innerHTML+=`
<button onclick="hireManager(${i})">
${b.name}: ${b.manager?"‚úÖ":"–ù–∞–Ω—è—Ç—å ("+b.cost*5+"$)"}
</button><br>
`;
});
}

//////////////// LOOP //////////////////

setInterval(()=>{

managerTick();
economyTick();

game.money+=game.income*game.bonus*game.economy;

updateLevel();
update();

},1000);

//////////////// UI //////////////////

function update(){

document.getElementById("money").innerText=Math.floor(game.money);
document.getElementById("income").innerText=
Math.floor(game.income*game.economy);
document.getElementById("level").innerText=game.level;
document.getElementById("bonus").innerText=
game.bonus.toFixed(1);

drawBiz();
drawManagers();
save();
}

//////////////// START //////////////////

load();
setEconomyText("–°—Ç–∞–±–∏–ª—å–Ω–æ");
update();

</script>
</body>
</html>































































































































































