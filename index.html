<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Mobile Game</title>

<style>
body{
  margin:0;
  overflow:hidden;
  background:#87CEEB;
  touch-action:none;
}

canvas{
  display:block;
}

.controls{
  position:fixed;
  bottom:20px;
  width:100%;
  display:flex;
  justify-content:space-between;
  padding:0 30px;
}

button{
  width:90px;
  height:90px;
  font-size:30px;
  border:none;
  border-radius:50%;
  background:#0008;
  color:white;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<div class="controls">
  <button id="left">◀</button>
  <button id="jump">▲</button>
  <button id="right">▶</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = innerWidth;
canvas.height = innerHeight;

let gravity = 0.7;

const player = {
  x:100,
  y:0,
  w:40,
  h:50,
  vx:0,
  vy:0,
  speed:5,
  jump:-15,
  onGround:false
};

const ground = {
  x:0,
  y:450,
  w:3000,
  h:50
};

let moveLeft = false;
let moveRight = false;
let cameraX = 0;

function update(){

  player.vx = 0;
  if(moveLeft) player.vx = -player.speed;
  if(moveRight) player.vx = player.speed;

  player.vy += gravity;

  player.x += player.vx;
  player.y += player.vy;

  if(player.y + player.h > ground.y){
    player.y = ground.y - player.h;
    player.vy = 0;
    player.onGround = true;
  } else {
    player.onGround = false;
  }

  cameraX = player.x - canvas.width/2;
}

function draw(){

  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.save();
  ctx.translate(-cameraX,0);

  ctx.fillStyle="#654321";
  ctx.fillRect(ground.x,ground.y,ground.w,ground.h);

  ctx.fillStyle="red";
  ctx.fillRect(player.x,player.y,player.w,player.h);

  ctx.restore();
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();

/* Управление */
const leftBtn = document.getElementById("left");
const rightBtn = document.getElementById("right");
const jumpBtn = document.getElementById("jump");

leftBtn.addEventListener("touchstart", ()=> moveLeft = true);
leftBtn.addEventListener("touchend", ()=> moveLeft = false);

rightBtn.addEventListener("touchstart", ()=> moveRight = true);
rightBtn.addEventListener("touchend", ()=> moveRight = false);

jumpBtn.addEventListener("touchstart", ()=>{
  if(player.onGround){
    player.vy = player.jump;
  }
});
</script>

</body>
</html>
